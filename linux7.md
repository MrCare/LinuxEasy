# Shell 编程基础

## 1. 概述

简介：

- shell 是内核的翻译器，是一个与内核交互的界面，Windows 的图形界面就是它的 shell

- shell 是一个功能强大的编程语言，是解释型语言，可以直接调用 Linux 系统命令

分类：

- Bourne Shell：从1979起Unix就开始使用Bourne Shell，其主文件名为

- C Shell：主要用在BSD版Unix系统中，其语法与C语言类似

- 两种主要语法类型完全不兼容，Bourne 家族主要包括sh，ksh，Bash，psh，zsh；C 家族主要包括csh，tcsh

Linux 中支持的 Shell：

- /etc/shells
  
  - sh；bash；tcsh；csh 
  
  - 默认是 bash 

## 2. Shell 脚本的执行方式

echo 输出命令：

- `echo`  + 选项 + “输出内容”
  - -e 支持转椅字符 \ 否则不支持
- 支持颜色输出

| 控制字符  | 作用                                  |
| ----- | ----------------------------------- |
| \\\   | 输出\                                 |
| \a    | 输出警告音                               |
| \b    | Backspace                           |
| \c    | 取消输出行末换行符，与“-n”选项一致                 |
| \e    | Esc                                 |
| \f    | 换页符                                 |
| \n    | 换行符                                 |
| \r    | 回车符                                 |
| \t    | Tab                                 |
| \v    | 垂直制表符                               |
| \0nnn | 按照8进制ASCII码表输出字符。其中0为数字零，nnn是三位八进制数 |
| \xhh  | 按照十六进制ASCII码表输出字符，其中hh是两位十六进制数      |

第一个脚本：

- vi hello.sh

- \#!/bin/Bash 第一行表示调用Bash执行脚本

执行脚本：

- 赋予执行权限，直接`./`运行
  
  - chmod 755 hello.sh
  
  - ./hello.sh

- 通过Bash调用执行脚本，不用执行权限
  
  - bash hello.sh

## 3. Bash 的基本功能

### 3.1 历史命令 & 补全

历史 命令：

- `history` + 选项 + 历史命令保存文件
  
  - -c 清空历史命令
  
  - -w 把缓存中的历史命令写入历史命令保存文件 **~/.bash_history**

- 历史命令默认保存1000条

- 上下箭头调用历史命令

- 使用“！n”重复执行第n条历史命令

- 使用“！！”重复执行上一条命令

- 使用“！字串”重复执行最后一条以该字串开头的命令

补全命令：

- 使用`Tab`键补全命令

### 3.2 别名 & 快捷键

别名：

- `alias` + 别名 + ‘原命令’
  
  - 命令执行的顺序：
    
    1. 用绝对路径或相对路径执行的命令
    
    2. 执行别名
    
    3. 执行 Bash 内部命令
    
    4. 按照 $PATH 环境变量定义的目录查找顺序找到的第一个命令
  
  - 查询别名： `which` + 命令

- 让别名永久生效：修改配置文件 **~/.bashrc**

- 删除别名：`unalias` + 别名

快捷键：

| 快捷键         | 作用                  |
|:----------- | ------------------- |
| `Ctrl` + a  | 把光标移动到命令行开头         |
| `Ctrl` + e  | 把光标移动到命令行结尾         |
| *`Ctrl` + c | 强制终止当前的命令           |
| *`Ctrl` + l | 清屏，相当于 clear 命令     |
| *`Ctrl` + u | 剪切光标之前的命令           |
| `Ctrl` + k  | 剪切光标之后内容            |
| *`Ctrl` + y | 粘贴                  |
| *`Ctrl` + r | 在历史命令中搜索，按下后会出现搜索界面 |
| *`Ctrl` + d | 退出当前终端              |
| `Ctrl` + z  | 暂停并放入后台             |
| `Ctrl` + s  | 暂停屏幕输出              |
| `Ctrl` + q  | 恢复屏幕输出              |

### 3.3 输入输出重定向

标准输入输出：

| 设备  | 设备文件名       | 文件描述符 | 类型     |
| --- | ----------- | ----- | ------ |
| 键盘  | /dev/stdin  | 0     | 标准输入   |
| 显示器 | /dev/sdtout | 1     | 标准输出   |
| 显示器 | /dev/sdterr | 2     | 标准错误输出 |

输出重定向：

- 命令 >/dev/null   将无用的命令输出丢入垃圾箱

| 类型            | 符号                 | 作用                                |
| ------------- | ------------------ | --------------------------------- |
| 标准输出重定向       | 命令 > 文件            | 以**覆盖**的方式，把命令的正确输出输出到指定的文件or设备中  |
| ‘’            | 命令 >> 文件           | 以**追加**的方式，把命令的正确输出输出到指定的文件or设备中  |
| 标准错误输出重定向     | 错误命令 2> 文件         | 以**覆盖**的方式，把命令的错误输出输出到指定文件或设备中    |
| ‘’            | 错误命令 2>> 文件        | 以**追加**的方式，把命令的错误输出输出到指定文件或设备中    |
| 正确输出和错误输出同时保存 | 命令 > 文件 2>&1       | 以**覆盖**的方式，把正确输出和错误输出都保存在同一个文件中   |
| ‘’            | 命令 >> 文件 2>&1      | 以**追加**的方式                        |
| ‘’            | 命令 &> 文件           | 以**覆盖**的方式，把正确输出和错误输出都保存到同一个文件中   |
| ‘’            | 命令 &>> 文件          | 以**追加**的方式                        |
| ‘’            | 命令 >> 文件1  2>> 文件2 | 把正确输出**追加**到文件1中，把错误输出**追加**到文件2中 |

输入重定向：

- `wc` + 选项 + 文件名
  
  - -c 统计字节数
  
  - -w 统计单词数
  
  - -l 统计行数

- `wc` 之后输入一些字符 `Ctrl + d`会统计输出的 “行数，单词数，字符数”

- 命令 < 文件   把文件作为命令的输入
  
  - eg：wc < 某文件  统计某文件信息

### 3.4 多命令顺序执行 & 管道符

多命令顺序执行：

| 多命令执行符 | 格式         | 作用                                      |
| ------ | ---------- | --------------------------------------- |
| ；      | 命令1 ； 命令2  | 多个命令顺序执行，命令之间没有逻辑联系                     |
| &&     | 命令1 && 命令2 | 逻辑与：当命令1正确执行，则命令2才会执行；当命令1执行错误时，命令2不会执行 |
|        |            |                                         |

- eg：`dd` + if=输入设备 + of=输出设备 + bs=字节数 + count=个数
  
  - 参数含义：
    
    - if=输入文件  指定源文件或源设备
    
    - of=输出文件  指定目标文件或目标设备
    
    - bs=字节数  指定一次输入/输出多少字节，即把这些字节看作一个数据块
    
    - count=个数  指定输入/输出多少个数据块

- 作用：进行磁盘复制

- 应用：
  
  - 命令 && echo yes || echo no  判断命令是否正确执行

管道符：

- 命令1 `|` 命令2
  
  - 命令1的正确输出作为命令2的操作对象

- eg：ll -a /etc | less   分屏显示前面命令的输出结果

- `grep` + 选项 + 搜索内容 + 文件名 
  
  - eg：netstat -an | grep ESTABLISHED   显示处于连接状态的用户

## 4. Bash 的变量

## 5. Bash 的运算符

## 6. 环境变量配置文件


